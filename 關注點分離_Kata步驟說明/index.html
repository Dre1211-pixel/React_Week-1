<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div id="app">
        <ul></ul>
    </div>
    <input type="text" id="inputByAdd">
    <button type="button" id="buttonByAdd">新增</button>
    <script>
        //資料集
        const data = [
            {
                id: 1,
                content: '我是Andrew'
            },
            {
                id: 2,
                content: '我是Annie'
            }
        ];
        //Step 1: 因為每一筆資料都有設定 id，所以我們可以先用 let 設定一個 num 變數抓取「陣列的長度」即代表陣列中有幾筆資料（和 id 值相同)
        let num = data.length;
        
        //Step 5: 取出「渲染」、input 資料、刪除 button 的元素
        const app = document.querySelector('#app ul'); //取得 ul 元素 
        const inputByAdd = document.querySelector('#inputByAdd'); //取得 input 元素
        const buttonByAdd = document.querySelector('#buttonByAdd'); //取得 button 元素
        
        //Step 6: 設計「新增資料」的按鈕功能
        buttonByAdd.addEventListener('click', function() {
            const val = inputByAdd.value; //取出 input 中的 value 
            inputByAdd.value = ''; //設定輸入的 value 欄位在點擊觸發監聽事件後自行清除欄位
            console.log(val); //可以先在 console 測試在欄位輸出並 click 新增按鈕資料會不會顯示在 console，確認無誤後即可將這行刪除
            addItem(val); //用 addItem 將 value 新增到資料集中
        });
        
        //Step 4: 製作「渲染」的函式結構
        function render() {
            let template = '';
            data.forEach(item => {
                template = template + `<li>${item.content}
                <button type="button" class="btnRemove" data-id="${item.id}">刪除</button></li>`;
            });
            app.innerHTML = template;
            
            //Step 7: 設計「刪除資料」的按鈕功能
            const btnsForRemove = document.querySelectorAll('.btnRemove');
            // console.log(btnsByRemove);
            btnsForRemove.forEach(btn => {
                btn.addEventListener('click', function(evt) {
                    // console.log(evt.target.dataset.id);
                    const id = Number.parseInt(evt.target.dataset.id);
                    // console.log(id);
                    removeItem(id);
                })
            })
        }

        //Step 2: 設計「新增資料」的資料處理控制
        function addItem(content) { //item 參數設定為資料的 content 項目值
            num++; //++ (increment operator) 代表將資料累加起來
            data.push({
                id: num, //讓 id = num
                content, //讓參數 content (資料中的 content 項目值) 作為資料內容 
            });
            render(); //「新增資料」函式裡面再執行一次 render，這樣每新增一筆資料就會將資料集渲染到畫面
        }
        // addItem('我叫作杰倫'); //註解：新增完「刪除資料」的資料處理控制後，可以把這一行移到 removeItem 函式的下面

        //Step 3: 設計「刪除資料」的資料處理控制
        function removeItem(id){  //item 參數設定為資料的 id 項目值
            const index = data.findIndex((item) => item.id === id); //找到資料的 id 項目值
            data.splice(index, 1); //刪除資料
            console.log(data); //console 檢視新增資料是否已添加到 data 資料集中，檢查完後即可刪除～
            render(); //「新增資料」函式裡面再執行一次 render，這樣每刪除一筆資料就會將資料集渲染到畫面
        }
        addItem('我叫作杰倫'); //註解：新增完「刪除資料」的資料處理控制後，可以把這一行移到 removeItem 函式的下面
        removeItem(2); //可以通過 id 將資料刪除；這邊我們選擇將 id = 2 的資料刪除
        console.log(data); //再用 console.log 檢視一下資料有沒有真的從 data 中移除    
        render(); //一般情況下，render (); 都是下在最下面，也就是初始畫面是不會顯示資料的，而是事件觸發後才會
    </script>
</body>
</html>